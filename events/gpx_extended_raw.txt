Format of the LVDS headers and raw TDC values


Header for triggered event:

word 0:
    bit 31:     header marker, always 1
    bit 30:     fragment marker, hopefully not used
    bit 29:     marker for asyncronous event, 0 in this case
    bit 28..18: extended overflow counter (11 bit) (C)
    bit 17..0:  size of event in bytes, header included
word 1: 
    bit 31..17  overflow counter (15 bit) (B)
    bit 16..0:  GPX time (17 bit) (A)
word 2:
    bit 31..0:  event counter

the time is calculated as:
t=A*92.59ps+(B+C*2^15)*6.4us
(C is currently not implemented)

overflow of the complete timestamp: 2^15*6.4us=209715.2us

Header for asyncronous event:

word 0:
    bit 31:     marker, always 1
    bit 30:     fragment marker, hopefully not used
    bit 29:     marker for asyncronous event, 1 in this case
    bit 28..18: unused
    bit 17..0:  size of event in bytes, header included
word 1: 
    bit 31..0:  some timestamp, probably not usable
word 2:
    bit 31..0:  event counter


TDC data words:
we have always two words in the extended raw mode

word 0:
    bit 31..28: module address
    bit 27..22: channel
    bit 21..18: overflow counter (4 bit) (B)
    bit 17:     edge bit (0: falling, 1: reising)
    bit 16..0:  GPX time (17 bit) (A)
word 1:
    bit 31..28: module address
    bit 27..16: unused (==0xfff)
    bit 15..0:  extended overflow counter (16 bit) (C)

the time is calculated as:
t=A*92.59ps+(B+C*2^4)*6.4us


the 6.4us are fixed in the hardware and will never change
but the 92.59ps are depending on the DAQ setup can have a different value
in future beam times; please do not 'hardwire' the value in the code

overflow of the complete timestamp: 2^20*6.4us=6710886.4us

